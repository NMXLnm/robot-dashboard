<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>机器人论坛</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body,#app{height:100%}
    body{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Helvetica Neue', Arial;
      background: #0f172a;
      color:#fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* 背景部分 */
    .bg-wrap{position:fixed;inset:0;overflow:hidden;z-index:-1;}
    .blob{
      position:absolute;width:70vmax;height:70vmax;top:50%;left:50%;
      transform:translate(-50%,-50%);
      filter: blur(60px) saturate(160%);
      opacity:1;
      mix-blend-mode:screen;
      border-radius:50%;
      animation-timing-function: ease-in-out;
    }
    .b1{background: radial-gradient(circle at 30% 30%, rgba(255,120,200,1), rgba(145,80,255,0.9), rgba(80,180,255,0.4));animation: float1 10s infinite;}
    .b2{background: radial-gradient(circle at 70% 40%, rgba(0,240,255,1), rgba(90,120,255,0.9), rgba(200,80,255,0.3));animation: float2 14s infinite;opacity:0.95;}
    .b3{background: radial-gradient(circle at 40% 70%, rgba(255,200,90,1), rgba(255,120,120,0.9), rgba(180,80,255,0.2));animation: float3 18s infinite;opacity:0.9;}
    @keyframes float1{0%{transform:translate(-52%,-48%) scale(1)}25%{transform:translate(-45%,-55%) scale(1.15)}50%{transform:translate(-48%,-52%) scale(0.9)}75%{transform:translate(-55%,-45%) scale(1.1)}100%{transform:translate(-52%,-48%) scale(1)}}
    @keyframes float2{0%{transform:translate(-55%,-55%) scale(1)}20%{transform:translate(-50%,-60%) scale(1.2)}50%{transform:translate(-60%,-50%) scale(0.85)}80%{transform:translate(-53%,-57%) scale(1.1)}100%{transform:translate(-55%,-55%) scale(1)}}
    @keyframes float3{0%{transform:translate(-45%,-45%) scale(1.2)}33%{transform:translate(-50%,-50%) scale(1)}66%{transform:translate(-40%,-55%) scale(1.25)}100%{transform:translate(-45%,-45%) scale(1.2)}}

    .noise{pointer-events:none;position:fixed;inset:0;mix-blend-mode:overlay;opacity:0.05;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 120 120"><defs><filter id="n"><feTurbulence baseFrequency="0.8" numOctaves="1" stitchTiles="stitch"/></filter></defs><rect width="120" height="120" fill="white" filter="url(%23n)"/></svg>');}

    /* Header */
    header {
      padding: 20px;
      text-align: center;
      font-size: 2em;
      font-weight: bold;
      background: rgba(0,0,0,0.3);
    }
    header nav a {
      font-size: 0.6em;
      margin: 0 10px;
      color: #0ff;
      text-decoration: none;
    }

    /* Forum Layout */
    .forum-container {
      max-width: 900px;
      margin: 30px auto;
      padding: 20px;
    }

    .post-card {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 15px;
      margin-bottom: 20px;
      backdrop-filter: blur(12px) saturate(150%);
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
    }

    .post-card h3 {
      margin-bottom: 10px;
    }
    .post-meta {
      font-size: 0.8em;
      opacity: 0.7;
      margin-bottom: 8px;
    }

    /* New post form */
    .new-post {
      background: rgba(255,255,255,0.08);
      border-radius: 16px;
      padding: 15px;
      margin-bottom: 30px;
      backdrop-filter: blur(12px) saturate(150%);
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
    }
    .new-post input, .new-post textarea {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 8px;
      border: none;
      outline: none;
      font-size: 1em;
    }
    .new-post button {
      padding: 10px 20px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      background: #0ff;
      color: #000;
    }
  </style>
</head>
<body>
  <div class="bg-wrap">
    <div class="blob b1"></div>
    <div class="blob b2"></div>
    <div class="blob b3"></div>
    <div class="noise"></div>
  </div>

  <header>
    💬 机器人论坛
    <nav>
      <a href="index.html">🏠 管理面板</a>
      <a href="settings.html">⚙ 设置</a>
    </nav>
  </header>

  <div class="forum-container">
    <!-- New Post -->
    <div class="new-post">
      <h2>发表新帖</h2>
      <input type="text" id="postTitle" placeholder="标题">
      <textarea id="postContent" rows="4" placeholder="内容"></textarea>
      <button onclick="addPost()">发布</button>
    </div>

    <!-- Posts -->
    <div id="posts"></div>
  </div>

  <!-- Firebase -->
  <script type="module" src="firebase.js"></script>
  <script type="module">
    import { getFirestore, collection, addDoc, getDocs, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { app } from "./firebase.js";

    const db = getFirestore(app);
    const postsContainer = document.getElementById("posts");

    async function loadPosts(){
      postsContainer.innerHTML = "";
      const q = query(collection(db, "posts"), orderBy("time","desc"));
      const snapshot = await getDocs(q);
      snapshot.forEach(doc=>{
        const p = doc.data();
        const div = document.createElement("div");
        div.className="post-card";
        div.innerHTML = `
          <h3>${p.title}</h3>
          <div class="post-meta">作者: ${p.author||"匿名"} | 时间: ${p.time?.toDate().toLocaleString()}</div>
          <p>${p.content}</p>
        `;
        postsContainer.appendChild(div);
      });
    }

    async function addPost(){
      const title=document.getElementById("postTitle").value.trim();
      const content=document.getElementById("postContent").value.trim();
      if(!title || !content) return alert("请填写完整！");
      await addDoc(collection(db,"posts"),{
        title,content,
        author:"匿名用户",
        time:serverTimestamp()
      });
      document.getElementById("postTitle").value="";
      document.getElementById("postContent").value="";
      loadPosts();
    }

    loadPosts();
  </script>
</body>
</html>
